# Tutor-Student System (ts-system)

Demo Application for tutors that need a system where they can manage their students

- [Design Points](#user-content-design-points)
- [Demo](#user-content-demo)
- [Usage](#user-content-usage)
- [Deploy to Heroku](#user-content-deploy-to-heroku)
- [Local Development](#user-content-local-development)

## Design Points

A combo of two npm projects, the backend server and the frontend UI. So there are two `package.json` configs and thereforce [two places to run `npm` commands](#user-content-local-development):

1. [**Node/Express.js Backend**](backend/): [`backend/package.json`](backend/package.json)
   - [deployed automatically](https://devcenter.heroku.com/categories/deployment) via heroku/nodejs buildpack
2. [**Next.js Client**](client/): [`client/package.json`](client/package.json)
   - generated by [Next.js](https://nextjs.org/)
   - deployed via `build` script in the Node server's [`./package.json`](package.json)
   - module cache configured by `cacheDirectories`

Includes a minimal [Node Cluster](https://nodejs.org/docs/latest-v8.x/api/cluster.html) [implementation](server/index.js) to parallelize the single-threaded Node process across the available CPU cores.

## Demo

[Demo deployment](https://quiet-coast-56774.herokuapp.com/): API calls from the Client app are fetched with a relative URL that is served by an Express handler in the Node server.

## Usage

To immediately test the API, there are three (3) modes that are implemented: Query, Register, Notification

1. **Query**

- In this mode, the user can enter in the input field provided one or more email addresses (separated with comma `,`) which identifies a tutor.
- If there's only one (1) email address, the client shows the associated students with that tutor. If there are two or more email addresses, the client shows the students common to the tutors.

2. **Register**

- In this mode, the user can immediately fill the provided JSON "template" which represents the request body structure (use `Shift+Enter` to insert newline).
- The API needs a valid tutor and students to be registered for that tutor.
- With this, the user can "register" students to a specific tutor. The tutor will be automatically created if it's missing.

3. **Notification**

- In this mode, the user can immediately fill the provided JSON "template" which represents the request body structure (use `Shift+Enter` to insert newline).
- The API needs a valid tutor and a notification that is not empty.
- The client will show the students that will receive the notification:
  - Students that are not suspended
  - Students that are registered/associated with the tutor
  - Students that have been mentioned in the notification

## Deploy to Heroku

```bash
git clone https://github.com/drichardcarl/ts-system.git
cd ts-system/
heroku create
git push heroku master
```

This deployment will automatically:

- detect [Node buildpack](https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-nodejs)
- build the app
- launch the web process with `npm start` and serves `client/out/` as static files

More about [deploying to Heroku](https://devcenter.heroku.com/categories/deployment).

## Local Development

Because this app is made of two npm projects, there are two places to run `npm` / `yarn` commands:

1. **Node/Express.js API server** in `backend` directory
2. **Next.js Client** in `client/` directory

### Run the API server

In a terminal:

```bash
# npm
npm install && npm run dev

# yarn
yarn && yarn dev
```

### Run the Next.js client app

In a separate terminal from the API server, start the UI:

```bash
# npm
npm install && npm run dev

# yarn
yarn && yarn dev
```
